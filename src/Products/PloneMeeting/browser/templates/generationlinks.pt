<div id="doc-generation-view"
     tal:condition="view/available"
     i18n:domain="collective.documentgenerator">
    <form name="podTemplateForm"
      method="POST"
      target="_blank"
      tal:attributes="action string:${context/absolute_url}/document-generation;">
    <input type="hidden" name="template_uid"/>
    <input type="hidden" name="output_format"/>
    <input type="hidden" name="uids" value=""/>
    <input type="hidden" name="facetedQuery" value=""/>
    <input type="hidden" name="mailinglist_name" value=""/>

    <ul class="pod-template">
        <li tal:repeat="infos view/get_links_info">
        <a href="#"
           tal:attributes="onclick string:event.preventDefault();;javascript:generatePodDocument('${infos/template_uid}','${infos/output_format}', this);
                           title infos/description"
           style="cursor: pointer">
            <img src="#"
             tal:attributes="src string:${view/portal_url}/++resource++collective.documentgenerator/${infos/output_format}.png" />
            <span tal:replace="infos/title">Template title</span>
        </a>

        <tal:comment replace="nothing">XXX Added by PloneMeting : send the document by email.</tal:comment>
        <tal:mail define="mailingLists python: view.getAvailableMailingLists(infos['template_uid'])"
                  condition="mailingLists">
            <img src="sendMail.gif"
                 tal:attributes="onClick string:toggleMenu('${infos/template_uid}_${infos/output_format}');
                                 src string:${view/portal_url}/sendMail.gif;"
                 style="cursor:pointer; position: relative;"/>
            <div tal:define="menuId string:pm_menu_${infos/template_uid}_${infos/output_format}"
                 tal:attributes="id menuId; name menuId" class="pmDropdown podTemplateSendmail discreet">
              <div style="clear: left;" tal:repeat="name mailingLists">
                <img style="float: left; padding-right: 0.3em;"
                     src="blue_arrow.gif"
                     tal:attributes="src string:${view/portal_url}/blue_arrow.gif"/>
                <a href="#"
                   class="template_send_mailing_list"
                   tal:content="name"
                   tal:attributes="onclick string:event.preventDefault();;javascript:$(this).parents('form')[0].mailinglist_name.value='${name}';;javascript:$(this).parents('form')[0].target='_self';;generatePodDocument('${infos/template_uid}','${infos/output_format}', this);;">
                    Mailing list name
                </a>
                </div>
                <div style="text-align: right;"
                     tal:attributes="onClick string:toggleMenu('${infos/template_uid}_${infos/output_format}');">
                    <img style="bottom: -13px; position: absolute; right: -13px; cursor: pointer;"
                         src="pb_close_small.png"
                         tal:attributes="src string:${view/portal_url}/pb_close_small.png"/>
                </div>
            </div>
        </tal:mail>

        </li>
    </ul>

    </form>
</div>
