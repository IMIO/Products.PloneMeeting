<tal:comment replace="nothing">
  This macro manage the isConfidential attribute of advices.
  advice : the relevant adviceInfo from the context.adviceIndex and context, the MeetingItem
</tal:comment>
<metal:isConfidential define-macro="isConfidential" i18n:domain="PloneMeeting"
                      tal:define="mayEdit python: context.adapted().mayEditAdviceConfidentiality();
                                  isConfidential advice/isConfidential;">
  <span tal:condition="mayEdit"
        id="marker_toggle_advice_isconfidential_UID__adviceId#"
        tal:attributes="id string:marker_toggle_advice_isconfidential_${UID}__${advice/id};"
        tal:define="UID context/UID;
                    baseUrl context/absolute_url;">
    <img class="adviceIsConfidentialEditable" tal:condition="isConfidential" name="isConfidentialNo" style="cursor:pointer"
         title="advice_is_confidential_yes_edit" i18n:attributes="title"
         tal:attributes="src string:$portal_url/isConfidentialYes.png;
                         onClick python: 'asyncToggleIcon(\''+UID + '__' + advice['id'] +'\', baseUrl=\'' + baseUrl + '\', viewName=\'@@toggle_advice_is_confidential\', baseSelector=\'#marker_toggle_advice_isconfidential_\')'"/>
    <img class="adviceIsConfidentialEditable" tal:condition="not: isConfidential" name="isConfidentialYes" style="cursor:pointer"
         title="advice_is_confidential_no_edit" i18n:attributes="title"
         tal:attributes="src string: $portal_url/isConfidentialNo.png;
                         onClick python: 'asyncToggleIcon(\''+UID + '__' + advice['id'] +'\', baseUrl=\'' + baseUrl + '\', viewName=\'@@toggle_advice_is_confidential\', baseSelector=\'#marker_toggle_advice_isconfidential_\')'"/>
  </span>
  <tal:notMayEdit condition="not: mayEdit">
    <img tal:condition="isConfidential" title="advice_is_confidential_yes" i18n:attributes="title"
         tal:attributes="src string: $portal_url/isConfidentialYes.png"/>
    <img tal:condition="not: isConfidential" title="advice_is_confidential_no" i18n:attributes="title"
         tal:attributes="src string: $portal_url/isConfidentialNo.png"/>
  </tal:notMayEdit>
</metal:isConfidential>
