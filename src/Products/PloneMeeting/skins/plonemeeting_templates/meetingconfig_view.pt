<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="PloneMeeting">

  <body>
  <metal:title fill-slot="content-title">
    <h1 class="documentFirstHeading">
        <span tal:content="context/Title"></span>
    </h1>
  </metal:title>
  <metal:description fill-slot="content-description">
   <tal:comment replace="nothing">Just hide the description as shown by default by Plone</tal:comment>
  </metal:description>

  <metal:fill fill-slot="content-core">
    <metal:main_macro define-macro="body"
                      tal:define="tool python: context.aq_inner.aq_parent;
                                  context_url python: context.absolute_url();
                                  isManager python: tool.isManager(context);
                                  isRealManager python: tool.isManager(realManagers=True);
                                  mode python:'view';
                                  pageName request/pageName|string:default;
                                  schematas python: here.Schemata();
                                  fieldsets python:[key for key in schematas.keys() if (key not in ('metadata', 'settings'))];
                                  displayable_fieldsets python: list(fieldsets);
                                  toLocalizedTime python:context.restrictedTraverse('@@plone').toLocalizedTime">

    <tal:hideToNonManagers condition="nocall:isManager">

    <span tal:repeat="fieldset displayable_fieldsets">
      [
      <tal:otherFieldset condition="python: pageName!=fieldset"><a
        tal:attributes="href python:context_url + '?pageName=%s'%fieldset" tal:condition="python: pageName!=fieldset">
        <span tal:content="fieldset" i18n:translate=""></span></a>
      </tal:otherFieldset>
      <tal:currentFieldset condition="python: pageName==fieldset"><b><span
        tal:content="fieldset" i18n:translate=""></span></b>
      </tal:currentFieldset>
      <tal:edit condition="python: fieldset in fieldsets and schematas[fieldset].editableFields(here, visible_only=True)">
      <a title="Edit"
         i18n:attributes="title"
         tal:attributes="href string:${context_url}/base_edit?fieldset=${fieldset}">
        <img tal:attributes="src string:$portal_url/edit.png" />
      </a>
    </tal:edit>]
    </span><br/><br/>

    <tal:mainConfig condition="python: pageName=='default'">
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="25%" tal:define="field python:here.getField('folderTitle')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <!-- I cannot use the standard macro for displaying this field because the
               widget condition prevents the widget from being displayed. -->
          <td width="25%">
            <div class="field ArchetypesField-BooleanField">
            <label class="formQuestion">
              <span i18n:translate="PloneMeeting_label_shortName">Shortname</span>:
            </label>
            <span tal:content="context/getShortName"/>
            </div>
          </td>
          <td width="25%" tal:define="field python:here.getField('isDefault')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="25%" tal:define="field python:here.getField('itemIconColor')">
            <img class="itemIconColor"
                 tal:attributes="src string:${portal_url}/${here/getItemIconColorName}" />
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('configGroup')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('places')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('lastMeetingNumber')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('yearlyInitMeetingNumbers')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('budgetDefault')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('configVersion')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
          <td>
          </td>
        </tr>
      </table>

    <tal:comment replace="nothing">Display custom fields</tal:comment>
    <tal:customFields define="customFields python: context.getCustomFields(2)"
                      condition="customFields">
    <br/>
    <fieldset>
      <legend i18n:translate="">tool_plonemeeting_misc</legend>
      <table width="100%" class="discreet">
        <tr valign="top" tal:repeat="fieldLine customFields">
          <td tal:repeat="field fieldLine">
            <tal:thereIsAField condition="field">
              <metal:field use-macro="here/widgets/field/macros/view" />
            </tal:thereIsAField>
          </td>
        </tr>
      </table>
    </fieldset>
    </tal:customFields>

    <div class="configActions">
      <table tal:condition="isManager" class="discreet">
        <tr valign="top">
          <td>
            <tal:comment replace="nothing">Display groups and users linked to this MeetingConfig</tal:comment>
            <fieldset>
              <legend i18n:translate="" i18n:domain="collective.contact.plonegroup">Groups and users</legend>
              <p i18n:translate="meetingconfig_display_groups_and_users_descr" class='pageNameDescr'></p>
              <tal:groupsAndUsers tal:replace="structure python: context.displayGroupsAndUsers()" />
              <span tal:define="field python:here.getField('usingGroups')">
                <metal:block use-macro="here/widgets/field/macros/view" />
              </span>
            </fieldset>
          </td>
          <td tal:condition="isRealManager" style="padding-left: 0.75em;">
            <fieldset>
              <legend i18n:translate="heading_actions">Actions</legend>
              <p class="discreet" style="color: red; font-weight: bold;" i18n:translate="pm_tool_updates_warning">
              Warning: take care that launching these proceedings may take time, depending on the number of existing elements!  Do not launch during period of hig use!
              </p>
              <form name="updateAllLocalRolesForm" action="updateAllLocalRoles"
                    tal:attributes="action string:${tool/absolute_url}/update_all_local_roles">
                <p class="discreet" style="color: red;" i18n:translate="mc_update_all_local_roles_warning">
                    Warning: this will update every items and meetings of this configuration, it is only relevant if the field of the configuration that you changed specifies that you need to use this action.  If you only made little changes like adding or removing a state in a field, as an administrator, it is possible to update items and meetings from the dashboards.  To do this, select elements that need to be updated and use the \"Update from configuration\" batch action.
                </p>
                <input type="hidden" tal:attributes="value context/getMeetingTypeName" name="portal_type:list" />
                <input type="hidden" tal:attributes="value context/getItemTypeName" name="portal_type:list" />
                <input class="context" type="submit" name="updateAllLocalRoles"
                       onclick="event.preventDefault(); if (confirm(window.eval('are_you_sure'))) {this.form.submit();}"
                       value="mc_update_all_local_roles" i18n:attributes="value"/>
              </form>
              <form name="updateAnnexConfidentialityForm" action="updateAnnexConfidentiality">
                <p class="discreet" style="color: red;" i18n:translate="pm_update_annex_confidentiality_warning">
                    Warning: the action 'Initialize existing annexes confidentiality' will initialize every existing annex confidentiality to what is defined as default value in this meeting configuration (check the 'Advices and access' tab).
                </p>
                <input class="context"
                       type="submit" name="updateAnnexConfidentiality"
                       value="pm_update_annex_confidentiality"
                       onclick="event.preventDefault(); if (confirm(window.eval('are_you_sure'))) {this.form.submit();}"
                       i18n:attributes="value"/>
              </form>
              <form name="updateAdviceConfidentialityForm" action="updateAdviceConfidentiality">
                <p class="discreet" style="color: red;" i18n:translate="pm_update_advice_confidentiality_warning">
                    Warning: the action 'Initialize existing advices confidentiality' will initialize every existing advice confidentiality to what is defined as default value in this meeting configuration (check the 'Advices and access' tab).
                </p>
                <input class="context"
                       type="submit"
                       name="updateAdviceConfidentiality"
                       value="pm_update_advice_confidentiality"
                       onclick="event.preventDefault(); if (confirm(window.eval('are_you_sure'))) {this.form.submit();}"
                       i18n:attributes="value"/>
              </form>
              <form name="updatePersonalLabelsForm" action="updatePersonalLabels">
                <p class="discreet" style="color: red;" i18n:translate="pm_update_personal_labels_warning">
                    Warning: the action 'Initialize personal labels' will activate selected labels on every existing items that were last modified before given number of days for every users able to see these items.
                </p>
                <select name="personal_labels:list">
                  <option value="" i18n:translate="">Select a label</option>
                  <option tal:repeat="term context/get_labels_vocab"
                          tal:attributes="value term/value"
                          tal:content="term/title">Label title</option>
                </select>
                <br />
                <select name="modified_since_days:int">
                  <option value="30" i18n:translate="">Modified since (in days, default to 30 days)</option>
                  <option tal:repeat="value python: range(0, 100, 5)"
                          tal:attributes="value value"
                          tal:content="value">0</option>
                </select>
                <br />
                <input class="context"
                       type="submit"
                       name="updatePersonalLabels"
                       value="pm_update_personal_labels"
                       onclick="event.preventDefault(); if (confirm(window.eval('are_you_sure'))) {this.form.submit();}"
                       i18n:attributes="value"/>
              </form>
              <form name="checkPodTemplatesForm" action="checkPodTemplates">
                <p class="discreet" style="color: red;" i18n:translate="pm_check_pod_templates_warning">
                    Warning: the action 'Check Pod templates' will check that every Pod templates defined in the configuration are working correctly.
                </p>
                <input class="context"
                       type="submit" name="checkPodTemplates"
                       value="pm_check_pod_templates"
                       onclick="event.preventDefault(); if (confirm(window.eval('are_you_sure'))) {this.form.submit();}"
                       i18n:attributes="value"/>
              </form>
            </fieldset>
          </td>
        </tr>
      </table>
    </div>
    </tal:mainConfig>

    <tal:assembly_and_signatures condition="python: pageName=='assembly_and_signatures'">
      <p i18n:translate="meetingconfig_assembly_and_signatures_descr" class='pageNameDescr'></p><br />

      <tal:defines define="usedMeetingAttributes context/getUsedMeetingAttributes">
        <fieldset><legend class="warningInMeetingConfig" i18n:translate="">This meeting configuration uses following fields to manage assemblies and signatures</legend>
        <p class="warningInMeetingConfig"><span i18n:translate="">Free text fields</span> :</p>
        <ul>
          <li tal:condition="python: 'assembly' in usedMeetingAttributes" i18n:translate="title_assembly">Assembly</li>
          <li tal:condition="python: 'assembly_excused' in usedMeetingAttributes" i18n:translate="title_assembly_excused">Assembly excused</li>
          <li tal:condition="python: 'assembly_absents' in usedMeetingAttributes" i18n:translate="title_assembly_absents">Assembly absents</li>
          <li tal:condition="python: 'assembly_guests' in usedMeetingAttributes" i18n:translate="title_assembly_guests">Assembly guests</li>
          <li tal:condition="python: 'assembly_proxies' in usedMeetingAttributes" i18n:translate="title_assembly_proxies">Assembly proxies</li>
          <li tal:condition="python: 'assembly_staves' in usedMeetingAttributes" i18n:translate="title_assembly_staves">Assembly staves</li>
          <li tal:condition="python: 'signatures' in usedMeetingAttributes" i18n:translate="title_signatures">Signatures</li>
          <li tal:condition="python: 'assembly' not in usedMeetingAttributes and 'assembly_excused' not in usedMeetingAttributes and 'assembly_absents' not in usedMeetingAttributes and 'assembly_guests' not in usedMeetingAttributes and 'assembly_proxies' not in usedMeetingAttributes and 'assembly_staves' not in usedMeetingAttributes and 'signatures' not in usedMeetingAttributes" i18n:translate="None">None</li>
        </ul>
        <p class="warningInMeetingConfig"><span i18n:translate="">Contacts fields</span> :</p>
        <ul>
          <li tal:condition="python: 'attendees' in usedMeetingAttributes" i18n:translate="title_attendees">Attendees</li>
          <li tal:condition="python: 'excused' in usedMeetingAttributes" i18n:translate="title_excused">Excused</li>
          <li tal:condition="python: 'absents' in usedMeetingAttributes" i18n:translate="title_absents">Absents</li>
          <li tal:condition="python: 'replacements' in usedMeetingAttributes" i18n:translate="title_replacements">Replacements</li>
          <li tal:condition="python: 'signatories' in usedMeetingAttributes" i18n:translate="title_signatories">Signatories</li>
          <li tal:condition="python: 'attendees' not in usedMeetingAttributes and 'excused' not in usedMeetingAttributes and 'absents' not in usedMeetingAttributes and 'replacements' not in usedMeetingAttributes and 'signatories' not in usedMeetingAttributes" i18n:translate="None">None</li>
        </ul>
        </fieldset>
      </tal:defines>

      <br />

      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="50%">
            <tal:comment replace="nothing">We do not use the widget macro to be able to render 'assembly' using mimetype='text/x-html-safe'</tal:comment>
            <label class="formQuestion"><span i18n:translate="title_default_assembly"></span>:</label>
            <div class="field" tal:content="structure python: context.getAssembly(mimetype='text/x-html-safe') or '-'">Assembly</div>
          </td>
          <td width="50%">
            <tal:comment replace="nothing">We do not use the widget macro to be able to render 'assemblyStaves' using mimetype='text/x-html-safe'</tal:comment>
            <label class="formQuestion"><span i18n:translate="title_default_assembly_staves"></span>:</label>
            <div class="field" tal:content="structure python: context.getAssemblyStaves(mimetype='text/x-html-safe') or '-'">Assembly staves</div>
          </td>
        </tr>
        <tr>
          <td width="50%">
            <tal:comment replace="nothing">We do not use the widget macro to be able to render 'signatures' using mimetype='text/x-html-safe'</tal:comment>
            <label class="formQuestion"><span i18n:translate="title_default_signatures"></span>:</label>
            <div class="field" tal:content="structure python: context.getSignatures(mimetype='text/x-html-safe') or '-'">Assembly staves</div>
          </td>
          <td width="50%" tal:define="field python:here.getField('certifiedSignatures')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>

      <fieldset><legend i18n:translate="meetingconfig_contacts">Contacts management</legend>
        <p i18n:translate="meetingconfig_contacts_descr" class='pageNameDescr'>Contacts are a way to use representation of real attendees to manage assembly of meetings.</p><br />
        <h4>
          <img src="manage.png"
               style="vertical-align: baseline;"
               tal:attributes="src string:${portal_url}/manage.png;"/>
          <a href="" tal:attributes="href string:${portal_url}/contacts" i18n:translate="">Manage contacts</a>
        </h4>
        <table width="100%" class="discreet">
          <tr valign="top">
            <td width="50%" tal:define="field python:here.getField('orderedContacts')">
              <span metal:use-macro="here/widgets/field/macros/view" />
            </td>
            <td width="50%" tal:define="field python:here.getField('orderedItemInitiators')">
              <span metal:use-macro="here/widgets/field/macros/view" />
            </td>
          </tr>
          <tr valign="top">
            <td tal:define="field python:here.getField('selectableRedefinedPositionTypes')">
              <span metal:use-macro="here/widgets/field/macros/view" />
            </td>
            <td></td>
          </tr>
        </table>
      </fieldset>
    </tal:assembly_and_signatures>

    <tal:data condition="python: pageName=='data'">
      <p i18n:translate="meetingconfig_data_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('usedItemAttributes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('historizedItemAttributes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('recordItemHistoryStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('usedMeetingAttributes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('orderedAssociatedOrganizations')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('orderedGroupsInCharge')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('includeGroupsInChargeDefinedOnProposingGroup')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('includeGroupsInChargeDefinedOnCategory')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemReferenceFormat')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('computeItemReferenceForItemsOutOfMeeting')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enableLabels')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('toDiscussSetOnItemInsert')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('toDiscussDefault')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('toDiscussLateDefault')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('insertingMethodsOnAddItem')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('selectablePrivacies')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('allItemTags')">
            <b i18n:translate="PloneMeeting_label_allItemTags"></b>:
            <span tal:content="python: ', '.join(context.getAllItemTags().split('\n'))" />
          </td>
          <td tal:define="field python:here.getField('sortAllItemTags')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemFieldsToKeepConfigSortingFor')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('listTypes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('xhtmlTransformFields')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('xhtmlTransformTypes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('meetingConfigsToCloneTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemAutoSentToOtherMCStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemManualSentToOtherMCStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td width="34%" tal:define="field python:here.getField('contentsKeptOnSentToOtherMC')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('advicesKeptOnSentToOtherMC')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('annexToPrintMode')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('keepOriginalToPrintOfClonedItems')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('removeAnnexesPreviewsOnMeetingClosure')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('cssClassesToHide')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('hideCssClassesTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enabledItemActions')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>

      <tal:comment replace="nothing">Annex types</tal:comment>
      <p>&nbsp;</p>
      <a name="annexes_types"></a>
      <fieldset>
        <legend>
         <span i18n:translate="">Annex types</span>
        </legend>
        <p class="discreet" i18n:translate="annex_types_descr"></p><br />
        <tal:annexesCategories repeat="cat_group context/annexes_types/objectValues"
                               define="show_annexes_types python: 'show_annexes_types' in context.REQUEST;">
            <a name="#"
               tal:attributes="name cat_group/getId"></a>
            <table class="listing nosort" style="text-align: right;" width="100%"
                   tal:define="cat_group_url cat_group/absolute_url" width="100%;">
              <tr>
                <th class="nosort">
                  <h2 style="display: inline;">
                    <a href=""
                       tal:attributes="href cat_group/absolute_url"
                        tal:content="cat_group/Title">Group category title</a>
                  </h2>
                  <tal:forRealManagers condition="isRealManager">
                    <a href="#"
                       title="add_object"
                       i18n:attributes="title"
                       tal:define="addable_content_category_type python: cat_group.allowedContentTypes()[0].id"
                       tal:attributes="href string:${cat_group_url}/++add++${addable_content_category_type}">
                      <img src="#" tal:attributes="src string:$portal_url/new.png" />
                    </a>
                    <a href="#"
                       title="Edit attributes of this group of categories"
                       i18n:attributes="title"
                       tal:attributes="href string:${cat_group_url}/edit">
                      <img src="#" tal:attributes="src string:$portal_url/edit.png" />
                    </a>
                  </tal:forRealManagers>

                  <tal:additionalInformations
                    define="obj python: cat_group;
                            excludedFields python: ('id', 'description', 'title')">
                    <metal:addtionalInformations use-macro="here/@@pm-macros/additionalInformations" />
                  </tal:additionalInformations>

                </th>
                <th class="nosort" width="50px" i18n:translate="heading_is_active">Active?</th>
                <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
              </tr>
              <tr tal:condition="not: cat_group/objectValues">
                <td colspan="5" align="center" i18n:translate="">No annex types.</td>
              </tr>
              <tr tal:condition="not: show_annexes_types">
                <td colspan="5" align="center" i18n:translate="annexes_types_force_display_descr">
                  Annexes types are hidden by default, you can <a i18n:name="force_display" i18n:translate="force_display" href=".?pageName=data&show_annexes_types=1#annexes_types">force display</a>.
                </td>
              </tr>
              <tal:loop repeat="cat python:cat_group.objectValues()" condition="show_annexes_types">
              <tr tal:define="isActive cat/enabled;
                              oddrow repeat/cat/odd;
                              classOddEven python: oddrow and 'even' or 'odd';"
                  tal:attributes="class classOddEven"
                  valign="top">
                <td>
                  <h5>
                    <a tal:attributes="href cat/absolute_url;
                                       class python: not isActive and 'state-inactive' or ''"
                       tal:content="cat/Title">Annex category title</a>
                  </h5>
                  <div class="discreet" tal:define="descr cat/Description" tal:condition="descr" tal:content="descr">Category description</div>
                  <tal:additionalInformations
                    define="obj python: cat;
                            excludedFields python: ('id', 'description', 'title')">
                    <metal:addtionalInformations use-macro="here/@@pm-macros/additionalInformations" />
                  </tal:additionalInformations>

                  <div class="config_sub_categories">
                    <table class="listing nosort" style="text-align: right;" width="100%">
                      <tr>
                        <th class="nosort" width="200px">
                          <span i18n:translate="heading_subtypes">Sub types</span>
                          <tal:forRealManagers condition="isRealManager">
                            <a href="#"
                               title="add_object"
                               i18n:attributes="title"
                               tal:define="cat_url cat/absolute_url;
                                           addable_content_category_type python: cat.allowedContentTypes()[0].id"
                               tal:attributes="href string:${cat_url}/++add++${addable_content_category_type}">
                              <img src="#" tal:attributes="src string:$portal_url/new.png" />
                            </a>
                          </tal:forRealManagers>
                        </th>
                        <th class="nosort" width="50px" i18n:translate="heading_is_active">Active?</th>
                        <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
                      </tr>
                      <tr tal:condition="python: not cat.objectValues()">
                        <td colspan="5" align="center" i18n:translate="">No annex subtypes.</td>
                      </tr>
                      <tal:loop repeat="sub_cat python: cat.objectValues()">
                        <tr tal:define="isActive sub_cat/enabled;
                                        oddrow repeat/sub_cat/odd;
                                        classOddEven python: oddrow and 'even' or 'odd';"
                            tal:attributes="class classOddEven"
                            valign="top">
                          <td>
                            <h5>
                            <a tal:attributes="href sub_cat/absolute_url;
                                               class python: not isActive and 'state-inactive' or ''"
                               tal:content="sub_cat/Title">
                              Subcategory title</a>
                            </h5>
                            <div class="discreet" tal:define="descr sub_cat/Description" tal:condition="descr" tal:content="descr">Sub category description</div>
                            <tal:additionalInformations
                              define="obj python: sub_cat;
                                      excludedFields python: ('id', 'description', 'title')">
                              <metal:addtionalInformations use-macro="here/@@pm-macros/additionalInformations" />
                            </tal:additionalInformations>
                          </td>
                          <td i18n:domain="plone">
                            <span tal:condition="isActive" i18n:translate="">Yes</span>
                            <span class="state-inactive" tal:condition="not: isActive" i18n:translate="">No</span>
                          </td>
                          <td align="right">
                            <tal:actions replace="structure python: sub_cat.restrictedTraverse('@@actions_panel')(showActions=False, showTransitions=False, showArrows=True)" />
                          </td>
                        </tr>
                      </tal:loop>
                    </table>
                  </div>
                </td>
                <td i18n:domain="plone">
                  <span tal:condition="isActive" i18n:translate="">Yes</span>
                  <span class="state-inactive" tal:condition="not: isActive" i18n:translate="">No</span>
                </td>
                <td align="right">
                  <tal:actions replace="structure python: cat.restrictedTraverse('@@actions_panel')(showActions=False, showTransitions=False, showArrows=True)" />
                </td>
              </tr>
              </tal:loop>
            </table>
            <p>&nbsp;</p>
        </tal:annexesCategories>

      </fieldset>

      <tal:comment replace="nothing">Categories</tal:comment>
      <a name="categories"></a>
      <fieldset>
        <legend>
         <span i18n:translate="Categories"></span>
          <a href="#"
             class="link-overlay-pm"
             title="add_object"
             i18n:attributes="title"
             tal:condition="isRealManager"
             tal:attributes="href string:${context_url}/categories/++add++meetingcategory">
            <img src="#" tal:attributes="src string:$portal_url/new.png" />
          </a>
        </legend>
        <p class="discreet" i18n:translate="categories_descr"></p><br />
        <tal:defines define="cFolder python:context.categories;">
          <metal:addtionalInformations use-macro="here/@@pm-macros/categoriesInConfig" />
        </tal:defines>
      </fieldset>

      <tal:comment replace="nothing">Classifiers</tal:comment>
      <a name="classifiers"></a>
      <fieldset>
        <legend>
         <span i18n:translate="Classifiers"></span>
          <a href="#"
             class="link-overlay-pm"
             title="add_object"
             i18n:attributes="title"
             tal:condition="isRealManager"
             tal:attributes="href string:${context_url}/classifiers/++add++meetingcategory">
            <img src="#" tal:attributes="src string:$portal_url/new.png" />
          </a>
        </legend>
        <p class="discreet" i18n:translate="classifiers_descr"></p><br />
        <tal:defines define="cFolder python:context.classifiers;">
          <metal:addtionalInformations use-macro="here/@@pm-macros/categoriesInConfig" />
        </tal:defines>
      </fieldset>

      <tal:comment replace="nothing">Meeting categories</tal:comment>
      <a name="meetingcategories"></a>
      <fieldset>
        <legend>
         <span i18n:translate="Meeting categories"></span>
          <a href="#"
             class="link-overlay-pm"
             title="add_object"
             i18n:attributes="title"
             tal:condition="isRealManager"
             tal:attributes="href string:${context_url}/meetingcategories/++add++meetingcategory">
            <img src="#" tal:attributes="src string:$portal_url/new.png" />
          </a>
        </legend>
        <p class="discreet" i18n:translate="meeting_categories_descr"></p><br />
        <tal:defines define="cFolder python:context.meetingcategories;">
          <metal:addtionalInformations use-macro="here/@@pm-macros/categoriesInConfig" />
        </tal:defines>
      </fieldset>

      <!-- Recurring items -->
      <a name="recurringitems"></a>
      <fieldset>
        <legend>
          <span i18n:translate="RecurringItems"></span>
          <a href="#"
             title="add_object"
             i18n:attributes="title"
             tal:condition="isRealManager"
             tal:define="itemType python: context.getItemTypeName(configType='MeetingItemRecurring')"
             tal:attributes="href string:${context_url}/recurringitems/createObject?type_name=${itemType}">
            <img src="#" tal:attributes="src string:$portal_url/new.png" />
          </a>
        </legend>
        <p class="discreet" i18n:translate="recurring_items_descr"></p><br />
        <table class="listing nosort" align="right" width="100%"
               tal:define="rFolder python:context.recurringitems;
                           rFolderUrl python:rFolder.absolute_url();">
          <tr>
            <th class="nosort" width="50%" i18n:translate="listingheader_title">Title</th>
            <th class="nosort" i18n:translate="header_CreationDate" i18n:domain="collective.eeafaceted.z3ctable">Created</th>
            <th class="nosort" i18n:translate="header_ModificationDate" i18n:domain="collective.eeafaceted.z3ctable">Modified</th>
            <th class="nosort" i18n:translate="PloneMeeting_label_meetingTransitionInsertingMe">Meeting transition inserting me</th>
            <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
          </tr>
          <tr tal:condition="python: not rFolder.objectValues('MeetingItem')">
            <td colspan="5" align="center" i18n:translate="">no_recurring_item</td>
          </tr>
          <tal:loop repeat="obj python: context.getRecurringItems(onlyActive=False)">
          <tr tal:define="isActive python: here.portal_workflow.getInfoFor(obj, 'review_state') == 'active';
                          oddrow repeat/obj/odd;
                          classOddEven python: oddrow and 'even' or 'odd';" valign="top"
                tal:attributes="class python: not isActive and classOddEven+' state-inactive' or classOddEven"
                class="#">
            <td><h5><a tal:attributes="href python: obj.absolute_url()" tal:content="python: obj.Title()"></a></h5></td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.created(), long_format=True)">Created</span>
            </td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.modified(), long_format=True)">Modified</span>
            </td>
            <td><span tal:content="python: obj.getMeetingTransitionInsertingMe() or '-'" i18n:domain="plone" i18n:translate="">Transition inserting me</span></td>
            <td align="right">
              <tal:actions replace="structure python: obj.restrictedTraverse('@@config_actions_panel')(showActions=False, showTransitions=True, showArrows=True)" />
            </td>
          </tr>
          </tal:loop>
        </table>
      </fieldset>

      <!-- Item templates -->
      <a name="itemtemplates"></a>
      <fieldset>
        <legend>
         <span i18n:translate="Item templates"></span>
        </legend>
        <p class="discreet" i18n:translate="item_templates_descr"></p>
        <h4>
          <img src="manage.png"
               style="vertical-align: baseline;"
               tal:attributes="src string:${portal_url}/manage.png;"/>
          <a href="itemtemplates" i18n:translate="">Manage item templates</a>
        </h4>
        <p tal:define="default_template python:context.get_default_item_template(only_active=False);
                       default_template_review_state default_template/query_state"
           i18n:translate="">The default item template <span i18n:name="default_template_title"><img tal:attributes="src default_template/getIconURL" />
          <a tal:attributes="href default_template/absolute_url;
                             class string:contenttype-${default_template/portal_type} state-${default_template_review_state}"
             tal:content="default_template/Title">Default item template title</a></span> is <span i18n:name="default_template_review_state"
                tal:content="default_template_review_state"
                tal:attributes="class string:state-${default_template_review_state}"
                i18n:domain="plone"
                i18n:translate="">review_state</span>.</p>
      </fieldset>
    </tal:data>

    <tal:workflow condition="python: pageName=='workflow'">
      <p i18n:translate="meetingconfig_workflow_descr" class='pageNameDescr'></p><br />
      <p i18n:translate="warning_meetingconfig_edit_section_descr" style="color: red;">
        DO NOT CHANGE PARAMETERS DEFINED IN THIS SECTION UNLESS YOU ARE REALLY SURE WHAT YOU ARE DOING!
      </p><br />

      <table width="100%" class="discreet" tal:define="wfTool python: context.portal_workflow">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('itemWorkflow')">
            <span metal:use-macro="here/widgets/field/macros/view" />
            <span style="color: red;" tal:content="python: '{0}__{1}'.format(context.getId(), context.getItemWorkflow())"></span>
          </td>
          <td width="34%" tal:define="field python:here.getField('itemConditionsInterface')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('itemActionsInterface')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('meetingWorkflow')">
            <span metal:use-macro="here/widgets/field/macros/view" />
            <span style="color: red;" tal:content="python: '{0}__{1}'.format(context.getId(), context.getMeetingWorkflow())"></span>
          </td>
          <td tal:define="field python:here.getField('meetingConditionsInterface')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('meetingActionsInterface')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td colspan="3" tal:define="field python:here.getField('workflowAdaptations')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr>
          <td colspan="3" tal:define="field python:here.getField('itemWFValidationLevels');
                                      dummy python:here.REQUEST.set('translated_itemWFValidationLevels', True);">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('transitionsToConfirm')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('onTransitionFieldTransforms')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('onMeetingTransitionItemActionToExecute')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('meetingPresentItemWhenNoCurrentMeetingStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemPreferredMeetingStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>
    </tal:workflow>

    <tal:gui condition="python: pageName=='gui'">
      <p i18n:translate="meetingconfig_gui_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('itemColumns')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('availableItemsListVisibleColumns')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="34%" tal:define="field python:here.getField('itemsListVisibleColumns')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemActionsColumnConfig')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('meetingColumns')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enabledAnnexesBatchActions')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('dashboardItemsListingsFilters')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('dashboardMeetingAvailableItemsFilters')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('dashboardMeetingLinkedItemsFilters')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('dashboardMeetingsListingsFilters')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemsVisibleFields')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemsNotViewableVisibleFields')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemsNotViewableVisibleFieldsTALExpr')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemsListVisibleFields')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('redirectToNextMeeting')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('displayAvailableItemsTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('maxShownMeetings')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('toDoListSearches')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('groupsHiddenInDashboardFilter')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('usersHiddenInDashboardFilter')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('maxShownListings')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('maxShownAvailableItems')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('maxShownMeetingItems')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>

      <!-- Searches -->
      <a name="searches"></a>
      <fieldset>
        <legend>
          <span i18n:translate="Searches">Searches</span>
        </legend>
        <p class="discreet" i18n:translate="searches_descr"></p>
        <tal:isRealManager condition="isRealManager">
          <p i18n:translate="warning_meetingconfig_edit_section_descr" style="color: red;">
            DO NOT CHANGE PARAMETERS DEFINED IN THIS SECTION UNLESS YOU ARE REALLY SURE WHAT YOU ARE DOING!
          </p>
          <h4><img src="manage.png"
                   style="vertical-align: baseline;"
                  tal:attributes="src string:${portal_url}/manage.png;"/>
              <a href="searches/folder_contents" i18n:translate="">
                  Manage dashboard
              </a>
          </h4>
        </tal:isRealManager>
        <p>&nbsp;</p>

        <tal:searchesCategories repeat="cFolder python: context.searches.objectValues()">
            <table class="listing nosort" style="text-align: right;" width="100%"
                   tal:define="cFolderUrl cFolder/absolute_url" width="100%;">
              <tr>
                <th class="nosort" width="200px">
                    <span i18n:translate="config_search_title">Searches
                      <span i18n:name="search_title" tal:content="cFolder/Title">Folder title</span>
                    </span>
                    <input type="image"
                           style="cursor:pointer"
                           class="imageInput"
                           tal:attributes="
                              onClick python: 'href: window.location=\'%s/++add++DashboardCollection\'' % cFolderUrl;
                              src string:$portal_url/new.png"
                 title="add_object" i18n:attributes="title"
                 tal:condition="isRealManager"/>
                </th>
                <th class="nosort" i18n:translate="header_CreationDate" i18n:domain="collective.eeafaceted.z3ctable">Created</th>
                <th class="nosort" i18n:translate="header_ModificationDate" i18n:domain="collective.eeafaceted.z3ctable">Modified</th>
                <th class="nosort" width="400px" i18n:translate="heading_criteria">Criteria</th>
                <th class="nosort" i18n:translate="">Condition</th>
                <th class="nosort" width="50px" i18n:translate="heading_is_active">Active?</th>
                <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
              </tr>
              <tr tal:condition="python: not cFolder.objectValues()">
                <td colspan="5" align="center" i18n:translate="">no_collection_folder</td>
              </tr>
              <tal:loop repeat="obj python:cFolder.objectValues()">
              <tr tal:define="isActive obj/enabled;
                              oddrow repeat/obj/odd;
                              classOddEven python: oddrow and 'even' or 'odd';"
                  tal:attributes="class python: not isActive and classOddEven+' state-inactive' or classOddEven"
                  valign="top">
                <td>
                  <h5><a tal:attributes="href python: obj.absolute_url()" tal:content="python: obj.Title()">Collection title</a></h5>
                  (<span tal:content="python: obj.getId()">Collection id</span>)
                  <div class="discreet" tal:define="descr python: obj.Description()" tal:condition="descr" tal:content="descr">Collection description</div>
                </td>
                <td>
                  <span tal:content="python: toLocalizedTime(obj.created(), long_format=True)">Created</span>
                </td>
                <td>
                  <span tal:content="python: toLocalizedTime(obj.modified(), long_format=True)">Modified</span>
                </td>
                <td>
                  <span tal:content="python: obj.query">Criteria</span>
                  <div>
                    <label class="formQuestion">
                      <span i18n:translate="" i18n:domain="plone">Sort the collection on this index</span>
                    </label> :
                    <span tal:content="obj/sort_on|nothing" i18n:domain="plone" i18n:translate="">Sort on</span>
                  </div>
                  <div>
                    <label class="formQuestion">
                      <span i18n:translate="" i18n:domain="plone">Sort the results in reversed order</span>
                    </label> :
                    <span tal:content="python: obj.sort_reversed and 'boolean_value_true' or 'boolean_value_false'"
                          i18n:translate="">Sort reversed</span>
                  </div>
                  <div>
                    <label class="formQuestion">
                      <span i18n:translate="" i18n:domain="collective.eeafaceted.collectionwidget">Show number of items in filter</span>
                    </label> :
                    <span tal:content="python: obj.showNumberOfItems and 'boolean_value_true' or 'boolean_value_false'"
                          i18n:translate="">Show number of items in filter</span>
                  </div>
                  <div>
                    <label class="formQuestion">
                      <span>UID</span>
                    </label> :
                    <span tal:content="obj/UID">Show number of items in filter</span>
                  </div>
                </td>
                <td>
                  <span tal:content="obj/tal_condition">TAL Condition</span>
                </td>
                <td i18n:domain="plone">
                  <span tal:condition="isActive" i18n:translate="">Yes</span>
                  <span tal:condition="not: isActive" i18n:translate="">No</span>
                </td>
                <td align="right">
                  <tal:actions replace="structure python: obj.restrictedTraverse('@@actions_panel')(showActions=False, showTransitions=False, showArrows=True)" />
                </td>
              </tr>
              </tal:loop>
            </table>
            <p>&nbsp;</p>
        </tal:searchesCategories>
      </fieldset>

      <!-- Topics -->
      <a name="topics"></a>
      <fieldset tal:condition="python: 'topics' in context.objectIds('ATFolder')">
        <legend>
          <span i18n:translate="Topics" style="color: red;">Old topics</span>
        </legend>
        <p class="discreet" style="color: red;">This is kept for migration purpose, do not use anymore.</p><br />
        <table class="listing nosort" align="right" width="100%"
               tal:define="tFolder python:context.topics;
                           tFolderUrl tFolder/absolute_url" width="100%;">
          <tr>
            <th class="nosort" i18n:translate="listingheader_title">Title</th>
            <th class="nosort" i18n:translate="topic_linked_to_type">Linked to Meeting or MeetingItem?</th>
            <th class="nosort" i18n:translate="topic_search_script">Topic search script</th>
            <th class="nosort" i18n:translate="topic_tal_expression">Topic tal expression</th>
            <th class="nosort" width="50px" i18n:translate="heading_is_active">Active?</th>
            <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
          </tr>
          <tr tal:condition="python: not tFolder.objectValues('ATTopic')">
            <td colspan="5" align="center" i18n:translate="">no_topic_folder</td>
          </tr>
          <tal:loop repeat="obj python:tFolder.objectValues('ATTopic')">
          <tr tal:define="isActive python: here.portal_workflow.getInfoFor(obj, 'review_state') == 'active';
                          oddrow repeat/obj/odd;
                          classOddEven python: oddrow and 'even' or 'odd';"
              tal:attributes="class python: not isActive and classOddEven+' state-inactive' or classOddEven"
              valign="top">
            <td>
              <a i18n:translate="" tal:attributes="href obj/absolute_url" tal:content="obj/Title"></a>
              <div class="discreet" tal:define="descr obj/Description" tal:condition="descr" tal:content="descr"></div>
            </td>
            <td><p i18n:translate="" i18n:domain="plone" tal:content="python: obj.getProperty('meeting_topic_type')">Meeting or Item</p></td>
            <td><p i18n:translate="" tal:content="python: obj.getProperty('topic_search_script')">Topic search script Id</p></td>
            <td><p i18n:translate="" tal:content="python: obj.getProperty('topic_tal_expression')">Meeting or Item</p></td>
            <td i18n:domain="plone">
              <span tal:condition="isActive" i18n:translate="">Yes</span>
              <span tal:condition="not: isActive" i18n:translate="">No</span>
            </td>
            <td align="right">
              -
            </td>
          </tr>
          </tal:loop>
        </table>
      </fieldset>

    </tal:gui>

    <tal:mail condition="python: pageName=='mail'">
      <p i18n:translate="meetingconfig_mail_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('mailMode')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="34%" tal:define="field python:here.getField('mailItemEvents')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('mailMeetingEvents')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>
    </tal:mail>

    <tal:advices condition="python: pageName=='advices'">
      <p i18n:translate="meetingconfig_advice_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top" colspan="3">
          <td tal:define="field python:here.getField('useAdvices')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('usedAdviceTypes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('defaultAdviceType')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top" colspan="3">
          <td tal:define="field python:here.getField('selectableAdvisers')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('selectableAdviserUsers')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td>
          </td>
        </tr>
        <tr valign="top">
          <td width="34%" tal:define="field python:here.getField('itemAdviceStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('itemAdviceEditStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('itemAdviceViewStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('keepAccessToItemWhenAdvice')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enableAdviceInvalidation')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemAdviceInvalidateStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('adviceStyle')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enableAdviceProposingGroupComment')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('enforceAdviceMandatoriness')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('defaultAdviceHiddenDuringRedaction')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('transitionsReinitializingDelays')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('historizeItemDataWhenAdviceIsGiven')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('historizeAdviceIfGivenAndItemModified')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr>
          <td tal:define="field python:here.getField('itemWithGivenAdviceIsNotDeletable')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('inheritedAdviceRemoveableByAdviser')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td colspan="3">
            <fieldset tal:define="field python:here.getField('customAdvisers')">
              <legend>
                <span i18n:translate="PloneMeeting_label_customAdvisers"></span>
                <span class="fa fa-question-circle help-doc" onClick="toggleDetails('customAdvisersDoc', toggle_parent_active=false);"></span>
              </legend>
                  <div id="customAdvisersDoc" style="display:none">
                        <p class="discreet" i18n:translate="custom_advisers_full_descr" />
                      </div>
                  <span metal:use-macro="here/widgets/field/macros/view" />
            </fieldset>
          </td>
          <td></td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('powerAdvisersGroups')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
          <td></td>
        </tr>
        <tr valign="top">
          <td colspan="3" tal:define="field python:here.getField('powerObservers')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemBudgetInfosStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemGroupsInChargeStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemObserversStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('selectableCopyGroups')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemCopyGroupsStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('selectableRestrictedCopyGroups')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemRestrictedCopyGroupsStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('hideHistoryTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('hideItemHistoryCommentsToUsersOutsideProposingGroup')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('restrictAccessToSecretItems')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('restrictAccessToSecretItemsTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('hideNotViewableLinkedItemsTo')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('annexRestrictShownAndEditableAttributes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('ownerMayDeleteAnnexDecision')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('annexEditorMayInsertBarcode')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('itemAnnexConfidentialVisibleFor')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('adviceAnnexConfidentialVisibleFor')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('meetingAnnexConfidentialVisibleFor')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr>
          <td tal:define="field python:here.getField('enableAdviceConfidentiality')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('adviceConfidentialityDefault')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('adviceConfidentialFor')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr>
          <td tal:define="field python:here.getField('itemLabelsEditableByProposingGroupForever')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('itemInternalNotesEditableBy')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('usingGroups')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>
    </tal:advices>

    <tal:votes condition="python: pageName=='committees'">
      <p i18n:translate="meetingconfig_committees_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('orderedCommitteeContacts')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="34%" tal:define="field python:here.getField('itemCommitteesStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="33%" tal:define="field python:here.getField('itemCommitteesViewStates')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td colspan="3" tal:define="field python:here.getField('committees')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>
    </tal:votes>

    <tal:votes condition="python: pageName=='votes'">
      <p i18n:translate="meetingconfig_votes_descr" class='pageNameDescr'></p><br />
      <table width="100%" class="discreet">
        <tr valign="top">
          <td width="33%" tal:define="field python:here.getField('useVotes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td width="34%" tal:define="field python:here.getField('votesEncoder')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('usedPollTypes')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('defaultPollType')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td></td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('usedVoteValues')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('firstLinkedVoteUsedVoteValues')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('nextLinkedVotesUsedVoteValues')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
        <tr valign="top">
          <td tal:define="field python:here.getField('voteCondition')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('votesResultTALExpr')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
          <td tal:define="field python:here.getField('displayVotingGroup')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>
    </tal:votes>

    <tal:doc condition="python: pageName=='doc'">
      <p i18n:translate="meetingconfig_doc_descr" class='pageNameDescr'></p><br />

      <table width="100%" class="discreet">
        <tr valign="top">
          <td tal:define="field python:here.getField('meetingItemTemplatesToStoreAsAnnex')">
            <span metal:use-macro="here/widgets/field/macros/view" />
          </td>
        </tr>
      </table>

      <a name="podtemplates"></a>
      <fieldset tal:define="pFolder python:context.podtemplates;
                            pFolderUrl python: pFolder.absolute_url();
                            show_details python: context.REQUEST.get('show_details', False)">
        <legend>
         <span i18n:translate="PodTemplates"></span>
         <a href="#"
            class="link-overlay-pm"
            tal:condition="isRealManager"
            tal:attributes="href string:${context/podtemplates/absolute_url}/folder_factories">
          <img src="#" tal:attributes="src string:$portal_url/new.png;" />
         </a>
        </legend>
        <p class="discreet" i18n:translate="pod_templates_descr"></p>
        <p i18n:translate="warning_meetingconfig_edit_section_descr" style="color: red;">
          DO NOT CHANGE PARAMETERS DEFINED IN THIS SECTION UNLESS YOU ARE REALLY SURE WHAT YOU ARE DOING!
        </p>
        <p i18n:translate="warning_meetingconfig_edit_podtemplate_descr" style="color: red;">
          POD TEMPLATES MUST BE EDITED USING LIBREOFFICE ONLY, DO NOT USE MICROSOFT WORD TO EDIT THESE TEMPLATES!
        </p>
        <h3 i18n:translate="">Style templates</h3>
        <table class="listing nosort"
               align="right"
               width="100%"
               tal:define="templates python: pFolder.getFolderContents(contentFilter={'portal_type': ('StyleTemplate',)}, full_objects=True)">
          <tr>
            <th class="nosort" width="20px"></th>
            <th class="nosort" i18n:translate="listingheader_title">Title</th>
            <th class="nosort" i18n:translate="header_CreationDate" i18n:domain="collective.eeafaceted.z3ctable">Created</th>
            <th class="nosort" i18n:translate="header_ModificationDate" i18n:domain="collective.eeafaceted.z3ctable">Modified</th>
            <th class="nosort" width="130px"  i18n:translate="heading_actions">Actions</th>
          </tr>
          <tr tal:condition="python: not templates">
            <td colspan="4" align="center" i18n:translate="">no_style_pod_folder</td>
          </tr>
          <tal:loop repeat="obj templates">
          <tr tal:define="oddrow repeat/obj/odd;
                          classOddEven python: oddrow and 'even' or 'odd';"
             tal:attributes="class python: classOddEven"
             valign="top">
            <td align="center">
                <img title="Format"
                     class="svg-icon"
                     tal:attributes="src string:$portal_url/++resource++collective.documentgenerator/style.svg"/></td>
            <td>
                <h5>
                  <a tal:attributes="href python:obj.absolute_url();">
                    <span tal:content="python:obj.Title()" />
                  </a>
                </h5>
                <tal:additionalInformations
                    condition="show_details"
                    define="context python: obj;
                            excludedFields python: ()">
                    <metal:addtionalInformations use-macro="here/@@pm-macros/additionalInformations" />
                </tal:additionalInformations>
            </td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.created(), long_format=True)">Created</span>
            </td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.modified(), long_format=True)">Modified</span>
            </td>
            <td align="right">
              <tal:actions replace="structure python: obj.restrictedTraverse('@@actions_panel')(showActions=False, showTransitions=False, showArrows=False)" />
            </td>
          </tr>
          </tal:loop>
        </table>

        <h3 i18n:translate="">Document templates</h3>
        <table class="listing nosort" align="right" width="100%"
               tal:define="templates python:pFolder.getFolderContents(contentFilter={'portal_type': ('ConfigurablePODTemplate', 'DashboardPODTemplate')}, full_objects=True)" width="100%;">
          <tr>
            <th class="nosort" width="20px"></th>
            <th class="nosort" i18n:translate="listingheader_title">Title</th>
            <th class="nosort" i18n:translate="header_CreationDate" i18n:domain="collective.eeafaceted.z3ctable">Created</th>
            <th class="nosort" i18n:translate="header_ModificationDate" i18n:domain="collective.eeafaceted.z3ctable">Modified</th>
            <th class="nosort" width="200px" i18n:translate="listingheader_pod_template_or_odt_file">POD template or odt_file</th>
            <th class="nosort" width="50px" i18n:translate="heading_is_active">Active?</th>
            <th class="nosort" width="130px" i18n:translate="heading_actions">Actions</th>
          </tr>
          <tal:comment replace="nothing">No template is defined.</tal:comment>
          <tr tal:condition="python: not pFolder.objectValues()">
            <td colspan="6" align="center" i18n:translate="">no_pod_folder</td>
          </tr>
          <tal:loop repeat="obj templates">
          <tr tal:define="oddrow repeat/obj/odd;
                          classOddEven python: oddrow and 'even' or 'odd';"
             tal:attributes="class python: not obj.enabled and classOddEven+' state-inactive' or classOddEven"
             valign="top">
            <td align="center">
                <img tal:repeat="fmt obj/pod_formats"
                     title="Format"
                     class="svg-icon"
                     tal:attributes="title fmt;
                                     src string:$portal_url/++resource++collective.documentgenerator/$fmt.svg"/>
            </td>
            <td>
                <h5>
                  <a tal:attributes="href python: obj.absolute_url();">
                    <img src="#"
                         i18n:attributes="title"
                         i18n:domain="collective.eeafaceted.dashboard"
                         title="DashboardPODTemplate"
                         tal:condition="python: obj.portal_type == 'DashboardPODTemplate'"
                         tal:attributes="src string:${portal_url}/++resource++collective.eeafaceted.dashboard/dashboardpodtemplate.png" />
                    <span tal:content="obj/Title" />
                  </a>
                </h5>
                <tal:baseInformations
                    condition="not:show_details">
                    <div class="discreet"
                         tal:define="descr python: obj.Description()"
                         tal:condition="descr" tal:content="descr"></div>
                    <div class="discreet">
                       <label class="horizontal">Uid</label>
                       <div>
                         <span class="text-widget textline-field"
                               tal:content="python: obj.UID()">Uid</span>
                       </div>
                     </div>
                    <div class="discreet">
                       <label class="horizontal" i18n:domain="plone" i18n:translate="">File</label>
                       <div>
                         <span class="text-widget textline-field"
                               tal:content="python: obj.get_filename()"
                               tal:on-error="structure python: '<strong class=\'highlightValue\'>NOT FOUND?</strong>'"
                               >Filename</span>
                       </div>
                     </div>
                    <div class="discreet"
                         tal:define="mailing_lists python: obj.mailing_lists"
                         tal:condition="mailing_lists">
                       <label i18n:translate="mailing_lists"
                              i18n:domain="collective.documentgenerator"
                              class="horizontal">Mailing lists</label>
                       <div>
                         <span class="text-widget textline-field"
                               tal:content="mailing_lists">mailing_lists</span>
                       </div>
                     </div>
                    <div class="discreet"
                         tal:define="tal_condition python: obj.tal_condition"
                         tal:condition="tal_condition">
                       <label i18n:translate=""
                              i18n:domain="collective.behavior.talcondition"
                              class="horizontal">TAL condition expression</label>
                       <div>
                         <span class="text-widget textline-field"
                               tal:content="tal_condition">TAL condition</span>
                       </div>
                     </div>
                </tal:baseInformations>
                <tal:additionalInformations
                    condition="show_details"
                    define="context python: obj;
                            excludedFields python: ('pod_formats', 'enabled', 'tal_condition')">
                    <metal:addtionalInformations use-macro="here/@@pm-macros/additionalInformations" />
                </tal:additionalInformations>
            </td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.created(), long_format=True)">Created</span>
            </td>
            <td>
              <span tal:content="python: toLocalizedTime(obj.modified(), long_format=True)">Modified</span>
            </td>
            <td>
              <a tal:attributes="href string:${obj/absolute_url}/view/++widget++form.widgets.odt_file/@@download"
                 tal:condition="python: obj.odt_file">
                <img tal:attributes="src string:${portal_url}/download_icon.png;
                                     title string:Download"
                     i18n:domain="plone"
                     i18n:attributes="title" />
              </a>
              <a tal:define="podTemplateHolder python: obj.get_pod_template_to_use();
                             otherCfg python: tool.getMeetingConfig(podTemplateHolder)"
                 tal:attributes="href python: podTemplateHolder.absolute_url()"
                 tal:on-error="python: obj.pod_template_to_use"
                 tal:condition="python: obj.odt_file is None"
                 tal:content="python:otherCfg.Title(include_config_group=True) + '  ' + podTemplateHolder.Title()">File holder</a>
            </td>
            <td i18n:domain="plone">
              <span tal:condition="obj/enabled" i18n:translate="">Yes</span>
              <span tal:condition="not: obj/enabled" i18n:translate="">No</span>
            </td>
            <td align="right">
              <tal:actions replace="structure python: obj.restrictedTraverse('@@actions_panel')(showActions=False, showTransitions=False, showArrows=True)" />
            </td>
          </tr>
          </tal:loop>
        </table>
      </fieldset>
    </tal:doc>

    <div metal:define-macro="folderlisting">
      <tal:comment replace="nothing">Hide the folder_listing</tal:comment>
    </div>

    </tal:hideToNonManagers>

       </metal:main_macro>
    </metal:fill>
  </body>
</html>
